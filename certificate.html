<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Pulse Medical Certificate</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body {
            background: #0f172a;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Playfair Display', serif;
        }

        #certificate {
            width: 900px;
            height: 600px;
            background: linear-gradient(135deg, #0d1b2a, #1b263b);
            border-radius: 24px;
            padding: 60px;
            color: white;
            text-align: center;
            position: relative;
        }

        .footer {
            position: absolute;
            bottom: 35px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 14px;
            color: #94a3b8;
        }

        /* ===============================
   MOBILE CERTIFICATE MODAL UI
================================ */
        @media (max-width: 576px) {

            /* Modal container */
            #nameModal .modal-dialog {
                margin: 0;
                height: 100vh;
            }

            /* Modal content */
            .name-modal {
                height: 100vh;
                border-radius: 0 !important;
                padding: 40px 24px;
                display: flex;
                flex-direction: column;
                justify-content: center;
                gap: 24px;
            }

            /* Title */
            .name-modal h5 {
                font-size: 24px;
                letter-spacing: 0.4px;
            }

            /* Input */
            .name-modal input {
                font-size: 18px;
                padding: 16px;
                border-radius: 14px;
            }

            /* Button */
            .name-modal button {
                font-size: 18px;
                padding: 16px;
                border-radius: 14px;
                font-weight: 600;
            }
        }
    </style>
</head>

<body>

    <div id="certificate">
        <div class="modal fade" id="nameModal" tabindex="-1" data-bs-backdrop="static">
            <div class="modal-dialog modal-dialog-centered modal-fullscreen-sm-down">
                <div class="modal-content name-modal text-center">
                    <h5 class="fw-bold mb-4">Sertifikat olish</h5>

                    <input id="nameInput" type="text" class="form-control mb-4" placeholder="Ism va familiya">

                    <button class="btn btn-primary w-100" onclick="saveNameAndGenerate()">
                        ðŸŽ“ Sertifikatni yuklash
                    </button>
                </div>
            </div>
        </div>

        <h1 class="fw-bold">Pulse Medical</h1>
        <p class="text-secondary">PROUDLY PRESENTED TO</p>

        <h2 id="cert-name" class="my-3"></h2>

        <p id="cert-score" class="fs-5 d-flex justify-content-center align-items-center gap-2">
            <i class="bi bi-check-circle-fill text-success fs-3"></i>
        </p>

        <div class="my-4" style="height:2px;background:linear-gradient(to right,#ffd700,#fbbf24);"></div>

        <img src="Pulse.jpg" width="90" class="rounded-circle shadow">

        <div class="footer" id="cert-date"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <script>
        const data = JSON.parse(localStorage.getItem("certificateData"));
        const modal = new bootstrap.Modal(document.getElementById("nameModal"));

        if (!data) {
            alert("Sertifikat maâ€™lumotlari topilmadi");
        } else {
            modal.show();
        }

        function saveNameAndGenerate() {
            const name = document.getElementById("nameInput").value.trim();
            if (!name) {
                alert("Iltimos, ism familiyangizni kiriting");
                return;
            }

            // Name ni saqlash
            data.name = name;
            localStorage.setItem("certificateData", JSON.stringify(data));

            // Sertifikatni toâ€˜ldirish
            document.getElementById("cert-name").innerText = data.name;
            document.getElementById("cert-score").innerHTML +=
                `${data.score} / ${data.total} (${data.percent}%) â€¢ ${data.testTitle}`;
            document.getElementById("cert-date").innerText =
                `Pulse Medical â€¢ ${data.date}`;

            modal.hide();

            // ðŸ“¥ AVTOMATIK YUKLASH
            setTimeout(downloadCertificate, 500);
        }

        function downloadCertificate() {
            const cert = document.getElementById("certificate");

            html2canvas(cert, { scale: 2 }).then(canvas => {
                const link = document.createElement("a");
                link.href = canvas.toDataURL("image/png");
                link.download = "Pulse_Medical_Certificate.png";
                link.click();
            });
        }
    </script>

    <!-- NAME INPUT MODAL -->

</body>

</html>